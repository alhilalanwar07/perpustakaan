<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Daftar Buku</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <!-- Search Bar -->
  <ion-searchbar placeholder="Cari judul atau penulis" [(ngModel)]="searchTerm"></ion-searchbar>

  <!-- Category Filter -->
  <ion-segment [(ngModel)]="selectedCategory" class="ion-margin-bottom">
    <ion-segment-button *ngFor="let category of categories" [value]="category.id">
      <ion-label>{{ category.name }}</ion-label>
    </ion-segment-button>
  </ion-segment>

  <!-- Books Grid -->
  <div class="books-grid">
    <ion-card *ngFor="let book of filterBooks()" class="book-card">
      <div class="book-cover" [style.backgroundImage]="book.coverUrl ? 'url(' + book.coverUrl + ')' : 
      'url(https://api.dicebear.com/7.x/shapes/svg?seed=' + book.title + '&backgroundColor=c7d2fe)'">
        <div class="availability-badge" [class.available]="book.available">
          {{ book.available ? 'Tersedia' : 'Dipinjam' }}
        </div>
      </div>
      
      <ion-card-header>
        <ion-card-subtitle>{{ book.author }}</ion-card-subtitle>
        <ion-card-title>{{ book.title }}</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <p class="book-description">{{ book.description }}</p>
        
        <div class="book-stats">
          <div class="rating">
            <ion-icon name="star" color="warning"></ion-icon>
            {{ book.rating }}
          </div>
          <div class="copies">
            <ion-icon name="library-outline" [color]="book.color"></ion-icon>
            {{ book.availableCopies }}/{{ book.totalCopies }}
          </div>
        </div>

        <ion-progress-bar 
          [color]="getAvailabilityPercent(book) > 50 ? 'success' : 'warning'"
          [value]="getAvailabilityPercent(book) / 100">
        </ion-progress-bar>
        
        <div class="action-buttons">
          <ion-button expand="block" [color]="book.available ? 'primary' : 'medium'" [disabled]="!book.available">
            {{ book.available ? 'Pinjam Buku' : 'Tidak Tersedia' }}
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- FAB for adding new book (admin only) -->
  <ion-fab slot="fixed" vertical="bottom" horizontal="end">
    <ion-fab-button color="primary">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
